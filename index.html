<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>Hugo 公告系統（免登入）</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
body {
    font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
    background: radial-gradient(circle at top left, #0f0c29, #302b63, #24243e);
    color: #e0e0e0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    flex-direction: column;
    padding: 20px;
}
#container {
    background: rgba(30,30,40,0.9);
    border-radius: 15px;
    padding: 30px;
    width: 100%;
    max-width: 650px;
    text-align: center;
    box-shadow: 0 0 20px #ef39dd;
    animation: glow 2s infinite alternate;
}
@keyframes glow {
    0% { box-shadow: 0 0 20px #ef39dd; }
    100% { box-shadow: 0 0 40px #f555d7; }
}
h1 {
    font-size: 28px;
    margin-bottom: 20px;
    color: #ef39dd;
    text-shadow: 0 0 10px #f555d7;
}
form {
    display: flex;
    flex-direction: column;
    gap: 15px;
    text-align: left;
}
label {
    font-size: 16px;
    font-weight: bold;
    color: #ffffff;
}
select, input[type="text"], textarea {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #ef39dd;
    border-radius: 8px;
    background: rgba(20,20,30,0.8);
    color: #ffffff;
    outline: none;
    transition: 0.3s;
    font-size: 16px;
}
select:focus, input[type="text"]:focus, textarea:focus {
    border-color: #f555d7;
    box-shadow: 0 0 8px #f555d7;
}
input[type="button"], .auth-button {
    width: 100%;
    background-color: #ef39dd;
    color: white;
    padding: 14px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 18px;
    transition: 0.3s;
    position: relative;
    overflow: hidden;
}
input[type="button"]:hover, .auth-button:hover {
    background-color: #f555d7;
    box-shadow: 0 0 10px #f555d7;
}
.input-glow::before {
    content: "";
    position: absolute;
    top: -2px; left: -2px; right: -2px; bottom: -2px;
    background: linear-gradient(45deg, #ef39dd, #f555d7, #ef39dd);
    z-index: -1;
    border-radius: 8px;
    filter: blur(8px);
    opacity: 0.7;
    animation: animateBorder 3s linear infinite;
}
@keyframes animateBorder {
    0% { background-position: 0 0; }
    50% { background-position: 400% 0; }
    100% { background-position: 0 0; }
}
p {
    font-size: 16px;
    margin-bottom: 10px;
    color: #ffffff;
}
#error {
    color: #ff5555;
    font-size: 18px;
    font-weight: bold;
    text-align: center;
    margin-top: 20px;
}
#authLinkContainer {
    margin-top: 20px;
    text-align: center;
}
.webhook-container {
    display: flex;
    flex-direction: column;
    gap: 5px;
}
.webhook-container label {
    position: relative;
    padding-left: 30px;
    cursor: pointer;
    user-select: none;
}
.webhook-container input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
}
.webhook-container input[type="checkbox"] + span {
    position: absolute;
    top: 0;
    left: 0;
    height: 20px;
    width: 20px;
    background-color: rgba(20,20,30,0.8);
    border: 2px solid #ef39dd;
    border-radius: 4px;
}
.webhook-container input[type="checkbox"]:checked + span {
    background-color: #f5e942; /* 黃色 */
    box-shadow: 0 0 8px #f5e942;
}
@media screen and (min-width:500px){
    h1 { font-size: 32px; }
    select, input[type="text"], textarea, input[type="button"], .auth-button { font-size: 18px; height: 50px; }
}
</style>
</head>
<body>

<div id="container" style="display:none;">
    <h1>公告系統（免登入）</h1>
    <form id="announceForm">
        <p>據某人說，只要是帥/美的人發送的訊息，會有神秘的事情發生！</p>

        <label for="helper">請發送公告的人：</label>
        <select id="helper" name="helper" class="input-glow">
            <option value="最帥的Hugo">Hugo</option>
            <option value="小黃☃">小黃☃</option>
            <option value="芋兔">芋兔</option>
            <option value="南極熊ᵃʷᵃ ∞ ت𖧀ఌ">南極熊ᵃʷᵃ ∞ ت𖧀ఌ</option>
            <option value="叛逆灬步行貓 Walking Cat 🚶🐱">叛逆灬步行貓 Walking Cat 🚶🐱</option>
            <option value="符符：）">符符：）</option>
        </select>

        <label for="type">訊息類型：</label>
        <select id="type" class="input-glow">
            <option value="embed">Embed（預設）</option>
            <option value="text">純文字</option>
        </select>

        <div id="embedFields">
            <label for="task">公告主旨：</label>
            <input type="text" id="task" maxlength="100" class="input-glow">
        </div>

        <label for="alert">公告內文：</label>
        <textarea id="alert" rows="3" maxlength="200" class="input-glow"></textarea>

        <label>選擇發送 Webhook：</label>
        <div class="webhook-container">
            <label><input type="checkbox" class="webhook" value="https://discord.com/api/webhooks/1240290732103831603/sbEitRzOWZuFZ6YVvBKlWi407kfL3I4xeq28M2qJIypElfkIjKWIr_9dMEvNUykwBAg8"><span></span> 投票and公告</label>
            <label><input type="checkbox" class="webhook" value="https://discord.com/api/webhooks/1409399410345119817/ak9spi7jpY99NgFPWJx4Oe-Jm06m-xBwFsWGDmGzA7N7Rwdwa6Lz-9LSKlyXz2hpnh3t"><span></span> 聊天機器人</label>
            <label><input type="checkbox" class="webhook" value="https://discord.com/api/webhooks/1409398844755808256/v_MY7okYZqkJ1oucXw1tbs2p7OpMNayZpuLIdHL2UfsIuX-M6UIQZFwRhfCfqkyz02zq"><span></span> 規則機器人</label>
            <label><input type="checkbox" class="webhook" value="https://discord.com/api/webhooks/1409399513634046002/wot8d0YrCIA5qEVpfzx-ZPHxDSVXukb7xsmUPG5tYA6iN-jQWxkVzVMZHUOTJpcoTUHL"><span></span> 通知機器人</label>
            <label><input type="checkbox" class="webhook" value="https://discord.com/api/webhooks/1409422385156718622/kr191RYo9TKduMkNWnfQCqLZoypYXdBQyxxp98wY3bLBzWsmmr0C_qQpe-zznQIpcg_g"><span></span> 警告機器人</label>
        </div>

        <input type="button" value="提交" class="input-glow" onclick="sendMessage()">
    </form>
</div>

<div id="error"></div>

<div id="authLinkContainer" style="display:none;">
    <button class="auth-button input-glow" onclick="window.location.href='https://auth.walking-cat.com'">前往驗證頁面</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
const urlParams = new URLSearchParams(window.location.search);
const auth = urlParams.get('auth');

if(auth === 'success') {
    document.getElementById('container').style.display = 'block';
    window.history.replaceState({}, document.title, window.location.pathname);
} else if(auth === 'error') {
    document.getElementById('error').innerText = '錯誤！未經認證的帳號。';
    document.getElementById('authLinkContainer').style.display = 'block';
} else {
    document.getElementById('error').innerText = '未經認證，請由認證連結進入。';
    document.getElementById('authLinkContainer').style.display = 'block';
}

// 顯示/隱藏 embed 主旨欄位
document.getElementById('type').addEventListener('change', () => {
    document.getElementById('embedFields').style.display = document.getElementById('type').value === 'embed' ? 'block' : 'none';
});

function getCurrentTime() {
    const now = new Date();
    const padZero = num => num < 10 ? '0'+num : num;
    return `${now.getFullYear()}/${padZero(now.getMonth()+1)}/${padZero(now.getDate())} ${padZero(now.getHours())}:${padZero(now.getMinutes())}:${padZero(now.getSeconds())}`;
}

function sendMessage() {
    const type = document.getElementById('type').value;
    const selectValue = document.getElementById('helper').value;
    const taskValue = document.getElementById('task').value;
    const alertValue = document.getElementById('alert').value;
    const currentTime = getCurrentTime();

    const webhooks = Array.from(document.querySelectorAll('.webhook:checked')).map(cb => cb.value);
    if(webhooks.length === 0){
        Swal.fire({ title: "請至少選擇一個 Webhook", icon: "warning" });
        return;
    }

    webhooks.forEach(url => {
        let message;
        if(type === 'embed') {
            message = {
                embeds: [{
                    title: taskValue || "公告",
                    description: `發送訊息者: ${selectValue}\n公告內文: ${alertValue}`,
                    color: 16776960
                }]
            };
        } else {
            message = { content: alertValue };
        }

        fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(message)
        })
        .catch(err => console.error(err));
    });

    Swal.fire({ title: "訊息已送出", icon: "success" });
}
</script>

</body>
</html>

