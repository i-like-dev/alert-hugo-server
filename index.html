<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>å…¬å‘Šç³»çµ±ï¼ˆå…ç™»å…¥ï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* { box-sizing:border-box; margin:0; padding:0; }
html, body { width:100%; height:100%; overflow:hidden; }
body {
  font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
  background: linear-gradient(135deg,#0f0c29,#302b63,#24243e);
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.container {
  width:95%; max-width:600px;
  background: rgba(10,10,10,0.85);
  padding:30px; border-radius:20px;
  box-shadow: 0 0 40px rgba(0,255,255,0.3), 0 0 80px rgba(0,255,255,0.2);
  text-align:center; border:1px solid cyan;
  animation: fadeIn 1s ease;
}
h1 { font-size:28px; color:#00f7ff; margin-bottom:15px; text-shadow:0 0 10px #00f7ff; }
p.desc { color:#a0e5ff; font-size:15px; margin-bottom:25px; }
label { display:block; font-weight:bold; margin-top:15px; text-align:left; font-size:16px; color:#0ff; text-shadow:0 0 5px #0ff; }
select,input[type="text"],textarea { width:100%; padding:14px; margin-top:8px; border:2px solid #0ff; border-radius:12px; font-size:15px; background: rgba(0,0,0,0.3); color:#fff; box-shadow: 0 0 10px rgba(0,255,255,0.4); transition: all 0.3s ease; }
select:focus,input[type="text"]:focus,textarea:focus { border-color:#ff00ff; box-shadow:0 0 15px #ff00ff,0 0 25px rgba(255,0,255,0.3); background: rgba(0,0,0,0.5); animation: glow 1.2s infinite alternate; }
input[type="button"] { width:100%; background: linear-gradient(90deg,#ff00ff,#00ffff); color:white; padding:16px; margin-top:25px; border:none; border-radius:14px; cursor:pointer; font-size:18px; font-weight:bold; letter-spacing:1px; box-shadow:0 0 15px #ff00ff,0 0 25px #00ffff; transition: transform 0.2s ease, box-shadow 0.2s ease; }
input[type="button"]:hover { transform: scale(1.05); box-shadow: 0 0 25px #ff00ff,0 0 45px #00ffff; }
.checkbox-group { text-align:left; }
.checkbox-group label { display:block; font-weight:normal; color:#0ff; margin:5px 0; cursor:pointer; }
@keyframes glow { 0% { box-shadow:0 0 15px #ff00ff,0 0 25px rgba(255,0,255,0.3); } 50% { box-shadow:0 0 25px #ff00ff,0 0 45px rgba(255,0,255,0.4); } 100% { box-shadow:0 0 15px #ff00ff,0 0 25px rgba(255,0,255,0.3); } }
@keyframes fadeIn { from { opacity:0; transform: translateY(-20px);} to { opacity:1; transform: translateY(0);} }
</style>
</head>
<body>
<div id="app"></div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const app = document.getElementById("app");
  app.innerHTML = `
  <div class="container">
    <h1>å…¬å‘Šç³»çµ±ï¼ˆå…ç™»å…¥ï¼‰</h1>
    <p class="desc">æ“šæŸäººèªªåªè¦æ˜¯å¸¥/ç¾çš„äººç™¼é€çš„è¨Šæ¯ï¼Œæœƒæœ‰ç¥ç§˜çš„äº‹æƒ…ç™¼ç”Ÿï¼</p>
    <form id="form">
      <label>ç™¼é€äººï¼š</label><select id="helper">
        <option value="æœ€å¸¥çš„Hugo">Hugo</option>
        <option value="å°é»ƒâ˜ƒ">å°é»ƒâ˜ƒ</option>
        <option value="èŠ‹å…”">èŠ‹å…”</option>
        <option value="å—æ¥µç†ŠáµƒÊ·áµƒ âˆ Øªğ–§€à°Œ">å—æ¥µç†ŠáµƒÊ·áµƒ âˆ Øªğ–§€à°Œ</option>
        <option value="å›é€†ç¬æ­¥è¡Œè²“ Walking Cat ğŸš¶ğŸ±">å›é€†ç¬æ­¥è¡Œè²“ Walking Cat ğŸš¶ğŸ±</option>
        <option value="ç¬¦ç¬¦ï¼šï¼‰">ç¬¦ç¬¦ï¼šï¼‰</option>
      </select>
      <label>è¨Šæ¯é¡å‹ï¼š</label><select id="type">
        <option value="embed" selected>Embed</option>
        <option value="text">ç´”æ–‡å­—</option>
      </select>
      <div id="titleDiv">
        <label>å…¬å‘Šä¸»æ—¨ï¼š</label><input type="text" id="title" maxlength="100">
      </div>
      <label>å…¬å‘Šå…§æ–‡ï¼š</label><input required type="text" id="description" maxlength="300">
      <label>é¸æ“‡é »é“ï¼š</label><div class="checkbox-group">
        <label><input type="checkbox" value="æŠ•ç¥¨andå…¬å‘Š" checked> æŠ•ç¥¨andå…¬å‘Š</label>
        <label><input type="checkbox" value="å½±ç‰‡é€šçŸ¥"> å½±ç‰‡é€šçŸ¥</label>
        <label><input type="checkbox" value="èŠå¤©ç¾¤"> èŠå¤©ç¾¤</label>
        <label><input type="checkbox" value="è¦å‰‡"> è¦å‰‡</label>
      </div>
      <input type="button" value="æäº¤" onclick="sendMessage()">
    </form>
  </div>`
  const typeSelect = document.getElementById('type')
  const titleDiv = document.getElementById('titleDiv')
  typeSelect.addEventListener('change', () => {
    titleDiv.style.display = typeSelect.value === 'text' ? 'none' : 'block';
  })
  if (typeSelect.value === 'text') titleDiv.style.display = 'none';
});

function getCurrentTime(){
  const now=new Date();
  const pad=num=>num<10?'0'+num:num;
  return `${now.getFullYear()}/${pad(now.getMonth()+1)}/${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
}

function sendMessage() {
  const helper = document.getElementById("helper").value;
  const type = document.getElementById("type").value;
  const title = document.getElementById("title").value;
  const description = document.getElementById("description").value;
  const webhooks = [...document.querySelectorAll('.checkbox-group input:checked')].map(e => e.value);

  if (!webhooks.length) {
    Swal.fire("è«‹è‡³å°‘é¸æ“‡ä¸€å€‹é »é“", "", "warning");
    return;
  }

  const payload = {
    helper,
    type,
    title,
    description,
    webhooks,
  };

  fetch("https://script.google.com/macros/s/AKfycbz-wLvLJ3kXL4YTbQi2ltBg-oyLJwCxiS847tivPGjEx23oAybWffrWjV6F0IpzGZd1/exec", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === "success") {
      Swal.fire("é€å‡ºæˆåŠŸ", "", "success");
      document.getElementById('form').reset();
      document.getElementById('titleDiv').style.display = type === 'text' ? 'none' : 'block';
    } else {
      Swal.fire("ç™¼é€å¤±æ•—", data.message || "", "error");
    }
  })
  .catch(err => {
    Swal.fire("ç™¼ç”ŸéŒ¯èª¤", err, "error");
  });
}
</script>
</body>
</html>
